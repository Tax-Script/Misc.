local userKey = script_key

local validKeys = {
    ["TAX-Free Script"] = true,
    ["exbujollwaxbo5"] = true,
    ["fhiwaxvvxzki158oj"] = true
}

if not validKeys[userKey] then
    setclipboard("QQ群号：885775764")
    game.Players.LocalPlayer:Kick("卡密错误或已失效, Q群号已复制到剪切板")
    return
end

local function replaceWTB()
    local function translateWTB(text)
        if not text or type(text) ~= "string" then return text end
        return text:gsub("WTB", "TAX-HUB"):gsub("wtb", "TAX-HUB")
    end

    local success, err = pcall(function()
        local oldIndex = getrawmetatable(game).__newindex
        setreadonly(getrawmetatable(game), false)
        
        getrawmetatable(game).__newindex = newcclosure(function(t, k, v)
            if (t:IsA("TextLabel") or t:IsA("TextButton") or t:IsA("TextBox")) and k == "Text" then
                v = translateWTB(tostring(v))
            end
            return oldIndex(t, k, v)
        end)
        
        setreadonly(getrawmetatable(game), true)
    end)
    
    if not success then
        game:GetService("CoreGui").DescendantAdded:Connect(function(descendant)
            if descendant:IsA("TextLabel") or descendant:IsA("TextButton") or descendant:IsA("TextBox") then
                task.wait(0.5)
                pcall(function()
                    local text = descendant.Text
                    if text and text ~= "" and text:find("WTB") then
                        descendant.Text = text:gsub("WTB", "TAX-HUB")
                    end
                end)
            end
        end)
    end
end

replaceWTB()

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "StellarLoader"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(1, 0, 1, 0)
frame.BackgroundTransparency = 1

local function destroyLoader()
    wait(2)
    screenGui:Destroy()
end

destroyLoader()

local StellarLibrary = (loadstring(game:HttpGet("https://raw.githubusercontent.com/Potato5466794/GC-WTB/refs/heads/main/UI/WTB-UI.luau")))();
if StellarLibrary:LoadAnimation() then
    StellarLibrary:StartLoad();
end;
if StellarLibrary:LoadAnimation() then
    StellarLibrary:Loaded();
end;
local UserInputService = game:GetService("UserInputService")
local Window = StellarLibrary:Window({
    SubTitle = "by TAX",
    Size = game:GetService("UserInputService").TouchEnabled and UDim2.new(0, 500, 0, 350) or UDim2.new(0, 500, 0, 320),
    TabWidth = 140
})

local UniversalTab = Window:Tab("通用", "rbxassetid://10723407389")
local PartUniversalTab = Window:Tab("部分通用加载器", "rbxassetid://10723407389")
local BattleTab = Window:Tab("最强战场", "rbxassetid://10723415335") 
local UltimateBattleTab = Window:Tab("终极战场", "rbxassetid://10723415335")
local PlantTab = Window:Tab("植物大战机器人", "rbxassetid://10709782497")
local SlapTab = Window:Tab("巴掌大战", "rbxassetid://10723407389")

UniversalTab:Button("飞行", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/Misc./refs/heads/main/flyv3"))()
end)

Notice = PartUniversalTab:Label("原脚本作者已改路径，此脚本暂时失效")

PartUniversalTab:Button("DYHUB TAX汉化", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/TaxHub/main/DYHUB"))()
end)

BattleTab:Seperator("功能脚本")
BattleTab:Button("VexonHub TAX汉化", function()
    script_key = "TAX_Free"
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/TaxHub/main/VexonHub"))()
end)

BattleTab:Button("phantasm Kenny汉化", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/ke9460394-dot/ugik/refs/heads/main/phantasm.lua"))()
end)

BattleTab:Button("DoviHUB (需解卡)", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/needanewphone32-eng/tsbfiles/refs/heads/main/Main1.lua"))()
end)

BattleTab:Button("nicuse TAX汉化 (需解卡)", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/TaxHub/refs/heads/main/nicuse"))()
end)

BattleTab:Seperator("杂项")
BattleTab:Button("全英雄动作脚本", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Mautiku/ehh/main/strong%20guest.lua.txt"))()
end)

UltimateBattleTab:Button("Xi Pro", function()
    loadstring(game:HttpGet("http://raw.githubusercontent.com/123fa98/Xi_Pro/refs/heads/main/免费/终极战场.lua"))()
end)

PlantTab:Button("植物大战机器人 TAX汉化", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/TaxHub/main/PLAINS%20VS%20BRAINROTS"))()
end)

SlapTab:Button("CludeHub TAX汉化", function()
    Custom_key = "TAX_Free"
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Tax-Script/TaxHub/refs/heads/main/CludeHub"))()
end)
